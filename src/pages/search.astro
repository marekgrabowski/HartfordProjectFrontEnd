---
import Layout from "../layouts/Layout.astro";
import ContainerLarge from "../components/ContainerLarge.astro";

// Grab Our API w/ Vehicle List
interface Vehicle {
  id: number;
  make: string;
  model: string;
  year: number;
}

const response = await fetch(
  "https://13g2g9a95h.execute-api.us-east-1.amazonaws.com/test1/vehicles"
);
const data = await response.json();
//console.log(data);
// Create list of Makes to populate drop down
const vehicleList: Vehicle[] = JSON.parse(data.body);
const makes: string[] = vehicleList.map((vehicle) => vehicle.make);

const uniqueMakes: string[] = Array.from(new Set(makes));

// Function to filter models based on selected make
function filterModels(selectedMake: string): string[] {
  const filteredModels = vehicleList
    .filter((vehicle) => vehicle.make === selectedMake)
    .map((vehicle) => vehicle.model);
  return filteredModels;
}

// Example: Select a make
const selectedMake = "Toyota"; // Replace with the selected make

// Get models based on the selected make
const selectedModels: string[] = filterModels(selectedMake);



---

<Layout title="TWW Hartford Project.">
  <main>
    <ContainerLarge>
      <h1 class="text-center text-3xl font-medium p-4">Vehicle Search</h1>
      <p class="text-center pb-5">
        Select a Make Model and Year from the drop downs to lookup a vechicle
      </p>
      <div class="flex justify-center">
        <div class="flex flex-col text-center border-2 border-gray-200 p-12">
          <div>
            <label class="">Select Your Car's Make:</label>
            <select class="border-2" onchange="">
              {
                makes.map((make) => (
                  <option value={make} class="">
                    {make}
                  </option>
                ))
              }
            </select>
          </div>
          <div>
			<label class="">Select Your Car's Model:</label>
			<select class="border-2" onchange="">
				{
				  model.map((model) => (
					<option value={model} class="">
					  {model}
					</option>
				  ))
				}
			  </select>
          </div>
        </div>
      </div>
    </ContainerLarge>
  </main>
</Layout>
